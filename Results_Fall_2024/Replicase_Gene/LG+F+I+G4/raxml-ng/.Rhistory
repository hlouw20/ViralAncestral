ires$Name4[23] <- "IRES1"
ires$Name4[33] <- "IRES0"
ires$Name4[34] <- "IRES0"
ires$Name4[47] <- "IRES0"
ires$Name4[62] <- "IRES2"
ires$Name4[100] <- "IRES2"
View(ires)
fiveUTR$id <- gsub(".*(NC_\\w+).*", "\\1", fiveUTR$seq.name)
RepNT$id <- gsub(".*(NC_\\w+).*", "\\1", RepNT$seq.name)
RepAA$id <- gsub(".*(NC_\\w+).*", "\\1", RepAA$seq.name)
ires$id <- gsub(".*(NC_\\w+).*", "\\1", ires$V1)
# 5'UTR Region
for (i in 0:5) {
# Filter data based on IRES type
filtered_df <- fiveUTR %>%
filter(id %in% ires$id[ires$Name4 == paste0("IRES", i)]) %>%
select(seq.name = seq_name, seq.text = sequence)  # Rename columns here
# Check if filtered_df is empty
if (nrow(filtered_df) == 0) {
cat("No data found for IRES", i, "\n")
} else {
# Define the output file path
outfile_path <- sprintf("~/Desktop/ViralAncestral/data/5UTR_Region/IRES_Subtypes/5UTR_ires%d_NT.fasta", i)
# Call dat2fasta with filtered data and outfile path
dat2fasta(filtered_df, outfile = outfile_path)
}
}
# 5'UTR Region
for (i in 0:5) {
# Filter data based on IRES type
filtered_df <- fiveUTR %>%
filter(id %in% ires$id[ires$Name4 == paste0("IRES", i)]) %>%
select(seq.name, seq.text)
# Check if filtered_df is empty
if (nrow(filtered_df) == 0) {
cat("No data found for IRES", i, "\n")
} else {
# Define the output file path
outfile_path <- sprintf("~/Desktop/ViralAncestral/data/5UTR_Region/IRES_Subtypes/5UTR_ires%d_NT.fasta", i)
# Call dat2fasta with filtered data and outfile path
dat2fasta(filtered_df, outfile = outfile_path)
}
}
library(Biostrings)
library(phylotools)
library(dplyr)
library(tidyr)
library(stringr)
setwd("~/Desktop/ViralAncestral/data/Original Data March 2023 (Start Here)")
# Read in 5'UTR NT, Replicase NT, Replicase AA, and IRES types
fiveUTR <- read.fasta("picornaviridae_5UTR_with_outgroup.fasta")
RepNT <- read.fasta("picornaviridae_replicase_nucleotide_with_outgroup.fasta")
RepAA <- read.fasta("picornaviridae_replicase_aminoacid_with_outgroup.fasta")
ires <- read.table("IRES_list.txt", fill = TRUE, sep = ",", header = FALSE)
ires <- ires %>% separate(V2, c("Name1", "Name2", "Name3", "Name4"))
ires$Name4[5] <- "IRES5"
ires$Name4[23] <- "IRES1"
ires$Name4[33] <- "IRES0"
ires$Name4[34] <- "IRES0"
ires$Name4[47] <- "IRES0"
ires$Name4[62] <- "IRES2"
ires$Name4[100] <- "IRES2"
fiveUTR$id <- gsub(".*(NC_\\w+).*", "\\1", fiveUTR$seq.name)
RepNT$id <- gsub(".*(NC_\\w+).*", "\\1", RepNT$seq.name)
RepAA$id <- gsub(".*(NC_\\w+).*", "\\1", RepAA$seq.name)
ires$id <- gsub(".*(NC_\\w+).*", "\\1", ires$V1)
for (i in 0:5) {
# Filter data based on IRES type
filtered_df <- fiveUTR %>%
filter(id %in% ires$id[ires$Name4 == paste0("IRES", i)]) %>% # filter by IRES type i
select(seq.name, seq.text) # select name and sequence --> need these column names for dat2fasta
# Check if filtered_df is empty
if (nrow(filtered_df) == 0) {
cat("No data found for IRES", i, "\n")
} else {
# Define the output file path
outfile_path <- sprintf("~/Desktop/ViralAncestral/data/5UTR_Region/IRES_Subtypes/5UTR_ires%d_NT.fasta", i)
# Call dat2fasta with filtered data and outfile path
dat2fasta(filtered_df, outfile = outfile_path) # write to FASTA file
}
}
for (i in 0:5) {
# Filter data based on IRES type
filtered_df <- RepNT %>%
filter(id %in% ires$id[ires$Name4 == paste0("IRES", i)]) %>% # filter by IRES type i
select(seq.name, seq.text)  # select name and sequence --> need these column names for dat2fasta
# Check if filtered_df is empty
if (nrow(filtered_df) == 0) {
cat("No data found for IRES", i, "\n")
} else {
# Define the output file path
outfile_path <- sprintf("~/Desktop/ViralAncestral/data/Replicase_Gene/IRES_Subtypes/Replicase_ires%d_NT.fasta", i)
# Call dat2fasta with filtered data and outfile path
dat2fasta(filtered_df, outfile = outfile_path) # write to FASTA file
}
}
for (i in 0:5) {
# Filter data based on IRES type
filtered_df <- RepAA %>%
filter(id %in% ires$id[ires$Name4 == paste0("IRES", i)]) %>% # filter by IRES type i
select(seq.name, seq.text) # select name and sequence --> need these column names for dat2fasta
# Check if filtered_df is empty
if (nrow(filtered_df) == 0) {
cat("No data found for IRES", i, "\n")
} else {
# Define the output file path
outfile_path <- sprintf("~/Desktop/ViralAncestral/data/Replicase_Gene/IRES_Subtypes/Replicase_ires%d_AA.fasta", i)
# Call dat2fasta with filtered data and outfile path
dat2fasta(filtered_df, outfile = outfile_path) # write to FASTA file
}
}
View(RepAA)
View(ires)
setwd("~/Desktop/ViralAncestral/results")
muscle_hmm_gtr_5utr_nt_ires1 <- read.tree("./5UTR_Trees/MFP/ML_Tree/5UTR_MUSCLE_ires1_MFP_NT_hmm.fasta.treefile")
muscle_hmm_sym_5utr_nt_ires1 <- read.tree("./5UTR_Trees/MFP/ML_Tree/5UTR_MUSCLE_ires1_MFP_NT_hmm.fasta.treefile")
muscle_hmm_sym_5utr_nt_ires1 <- read.tree("./5UTR_Trees/MFP/ML_Tree/5UTR_MUSCLE_ires1_MFP_NT_hmm.fasta.treefile")
muscle_hmm_tim3e_5utr_nt_ires2 <- read.tree("./5UTR_Trees/MFP/ML_Tree/5UTR_MUSCLE_ires2_MFP_NT_hmm.fasta.treefile")
muscle_hmm_hky_5utr_nt_ires3 <- read.tree("./5UTR_Trees/MFP/ML_Tree/5UTR_MUSCLE_ires3_MFP_NT_hmm.fasta.treefile")
muscle_hmm_sym_5utr_nt_ires1_rooted  <- midpoint.root(muscle_hmm_sym_5utr_nt_ires1, node.labels = "support")
muscle_hmm_sym_5utr_nt_ires1_rooted  <- midpoint_root(muscle_hmm_sym_5utr_nt_ires1, node.labels = "support")
library(phytools)
muscle_hmm_sym_5utr_nt_ires1_rooted  <- midpoint_root(muscle_hmm_sym_5utr_nt_ires1, node.labels = "support")
muscle_hmm_sym_5utr_nt_ires1_rooted  <- midpoint_root(muscle_hmm_sym_5utr_nt_ires1)
muscle_hmm_tim3e_5utr_nt_ires2_rooted <- midpoint_root(muscle_hmm_tim3e_5utr_nt_ires2)
muscle_hmm_hky_5utr_nt_ires3_rooted <- midpoint.root(muscle_hmm_hky_5utr_nt_ires3, node.labels = "support")
plotTree(muscle_hmm_sym_5utr_nt_ires1_rooted, ftype="i", fsize=0.5, lwd=1)
labelnodes(1:muscle_hmm_sym_5utr_nt_ires1_rooted$Nnode+Ntip(muscle_hmm_sym_5utr_nt_ires1_rooted),
1:muscle_hmm_sym_5utr_nt_ires1_rooted$Nnode+Ntip(muscle_hmm_sym_5utr_nt_ires1_rooted),
interactive = FALSE, cex = 0.5)
plotTree(muscle_hmm_sym_5utr_nt_ires1, ftype="i", fsize=0.5, lwd=1)
labelnodes(1:muscle_hmm_sym_5utr_nt_ires1$Nnode+Ntip(muscle_hmm_sym_5utr_nt_ires1),
1:muscle_hmm_sym_5utr_nt_ires1$Nnode+Ntip(muscle_hmm_sym_5utr_nt_ires1),
interactive = FALSE, cex = 0.5)
plotTree(muscle_hmm_sym_5utr_nt_ires1_rooted, ftype="i", fsize=0.01, lwd=1)
labelnodes(1:muscle_hmm_sym_5utr_nt_ires1_rooted$Nnode+Ntip(muscle_hmm_sym_5utr_nt_ires1_rooted),
1:muscle_hmm_sym_5utr_nt_ires1_rooted$Nnode+Ntip(muscle_hmm_sym_5utr_nt_ires1_rooted),
interactive = FALSE, cex = 0.5)
plotTree(muscle_hmm_sym_5utr_nt_ires1_rooted, ftype="i", fsize=0.5, lwd=1)
labelnodes(1:muscle_hmm_sym_5utr_nt_ires1_rooted$Nnode+Ntip(muscle_hmm_sym_5utr_nt_ires1_rooted),
1:muscle_hmm_sym_5utr_nt_ires1_rooted$Nnode+Ntip(muscle_hmm_sym_5utr_nt_ires1_rooted),
interactive = FALSE, cex = 0.01)
plotTree(muscle_hmm_sym_5utr_nt_ires1, ftype="i", fsize=0.5, lwd=1)
labelnodes(1:muscle_hmm_sym_5utr_nt_ires1$Nnode+Ntip(muscle_hmm_sym_5utr_nt_ires1),
1:muscle_hmm_sym_5utr_nt_ires1$Nnode+Ntip(muscle_hmm_sym_5utr_nt_ires1),
interactive = FALSE, cex = 0.01)
plotTree(muscle_hmm_sym_5utr_nt_ires1_rooted, ftype="i", fsize=0.5, lwd=1)
labelnodes(1:muscle_hmm_sym_5utr_nt_ires1_rooted$Nnode+Ntip(muscle_hmm_sym_5utr_nt_ires1_rooted),
1:muscle_hmm_sym_5utr_nt_ires1_rooted$Nnode+Ntip(muscle_hmm_sym_5utr_nt_ires1_rooted),
interactive = FALSE, cex = 0.1)
plotTree(muscle_hmm_sym_5utr_nt_ires1_rooted, ftype="i", fsize=0.5, lwd=1)
labelnodes(1:muscle_hmm_sym_5utr_nt_ires1_rooted$Nnode+Ntip(muscle_hmm_sym_5utr_nt_ires1_rooted),
1:muscle_hmm_sym_5utr_nt_ires1_rooted$Nnode+Ntip(muscle_hmm_sym_5utr_nt_ires1_rooted),
interactive = FALSE, cex = 0.25)
plotTree(muscle_hmm_sym_5utr_nt_ires1_rooted, ftype="i", fsize=0.5, lwd=1)
labelnodes(1:muscle_hmm_sym_5utr_nt_ires1_rooted$Nnode+Ntip(muscle_hmm_sym_5utr_nt_ires1_rooted),
1:muscle_hmm_sym_5utr_nt_ires1_rooted$Nnode+Ntip(muscle_hmm_sym_5utr_nt_ires1_rooted),
interactive = FALSE, cex = 0.2)
write.tree(muscle_hmm_sym_5utr_nt_ires1_rooted, file="./Rooted_Trees/muscle_hmm_sym_5utr_nt_ires1_rooted.treefile")
write.tree(muscle_hmm_tim3e_5utr_nt_ires2_rooted, file="./Rooted_Trees/muscle_hmm_tim3e_5utr_nt_ires2_rooted.treefile")
write.tree(muscle_hmm_hky_5utr_nt_ires3_rooted, file="./Rooted_Trees/muscle_hmm_hky_5utr_nt_ires3_rooted.treefile")
muscle_hmm_gtr_5utr_nt_ires1_rooted <- midpoint.root(muscle_hmm_gtr_5utr_nt_ires1, node.lables = "support")
muscle_hmm_gtr_5utr_nt_ires2_rooted <- midpoint.root(muscle_hmm_gtr_5utr_nt_ires2, node.lables = "support")
muscle_hmm_gtr_5utr_nt_ires1 <- read.tree("./5UTR_Trees/GTR+F+I+G4/ML_Tree/5UTR_MUSCLE_ires1_GTR_NT_hmm.fasta.treefile")
muscle_hmm_gtr_5utr_nt_ires2 <- read.tree("./5UTR_Trees/GTR+F+I+G4/ML_Tree/5UTR_MUSCLE_ires2_GTR_NT_hmm.fasta.treefile")
muscle_hmm_gtr_5utr_nt_ires3 <- read.tree("./5UTR_Trees/GTR+F+I+G4/ML_Tree/5UTR_MUSCLE_ires3_GTR_NT_hmm.fasta.treefile")
muscle_hmm_gtr_5utr_nt_ires1_rooted <- midpoint.root(muscle_hmm_gtr_5utr_nt_ires1, node.lables = "support")
muscle_hmm_gtr_5utr_nt_ires2_rooted <- midpoint.root(muscle_hmm_gtr_5utr_nt_ires2, node.lables = "support")
muscle_hmm_gtr_5utr_nt_ires3_rooted <- midpoint.root(muscle_hmm_gtr_5utr_nt_ires3, node.lables = "support")
muscle_hmm_gtr_5utr_nt_ires1 <- read.tree("./5UTR_Trees/GTR+F+I+G4/ML_Tree/5UTR_MUSCLE_ires1_GTR_NT_hmm.fasta.treefile")
muscle_hmm_gtr_5utr_nt_ires2 <- read.tree("./5UTR_Trees/GTR+F+I+G4/ML_Tree/5UTR_MUSCLE_ires2_GTR_NT_hmm.fasta.treefile")
muscle_hmm_gtr_5utr_nt_ires3 <- read.tree("./5UTR_Trees/GTR+F+I+G4/ML_Tree/5UTR_MUSCLE_ires3_GTR_NT_hmm.fasta.treefile")
muscle_hmm_gtr_5utr_nt_ires1_rooted <- midpoint.root(muscle_hmm_gtr_5utr_nt_ires1, node.lables = "support")
muscle_hmm_gtr_5utr_nt_ires2_rooted <- midpoint.root(muscle_hmm_gtr_5utr_nt_ires2, node.lables = "support")
muscle_hmm_gtr_5utr_nt_ires3_rooted <- midpoint.root(muscle_hmm_gtr_5utr_nt_ires3, node.lables = "support")
write.tree(muscle_hmm_gtr_5utr_nt_ires1_rooted, file="./Rooted_Trees/muscle_hmm_gtr_5utr_nt_ires1_rooted.treefile")
write.tree(muscle_hmm_gtr_5utr_nt_ires2_rooted, file="./Rooted_Trees/muscle_hmm_gtr_5utr_nt_ires2_rooted.treefile")
write.tree(muscle_hmm_gtr_5utr_nt_ires3_rooted, file="./Rooted_Trees/muscle_hmm_gtr_5utr_nt_ires3_rooted.treefile")
muscle_gtr_5utr_nt_ires1 <- read.tree("./5UTR_Trees/GTR+F+I+G4/ML_Tree/5UTR_MUSCLE_ires1_GTR_NT.fasta.treefile")
muscle_gtr_5utr_nt_ires2 <- read.tree("./5UTR_Trees/GTR+F+I+G4/ML_Tree/5UTR_MUSCLE_ires2_GTR_NT.fasta.treefile")
muscle_gtr_5utr_nt_ires3 <- read.tree("./5UTR_Trees/GTR+F+I+G4/ML_Tree/5UTR_MUSCLE_ires3_GTR_NT.fasta.treefile")
muscle_gtr_5utr_nt_ires1_rooted <- midpoint.root(muscle_gtr_5utr_nt_ires1, node.lables = "support")
muscle_gtr_5utr_nt_ires2_rooted <- midpoint.root(muscle_gtr_5utr_nt_ires2, node.lables = "support")
muscle_gtr_5utr_nt_ires3_rooted <- midpoint.root(muscle_gtr_5utr_nt_ires3, node.lables = "support")
write.tree(muscle_gtr_5utr_nt_ires1_rooted, file="./Rooted_Trees/5UTR/muscle_gtr_5utr_nt_ires1_rooted.treefile")
write.tree(muscle_gtr_5utr_nt_ires2_rooted, file="./Rooted_Trees/5UTR/muscle_gtr_5utr_nt_ires2_rooted.treefile")
write.tree(muscle_gtr_5utr_nt_ires3_rooted, file="./Rooted_Trees/5UTR/muscle_gtr_5utr_nt_ires3_rooted.treefile")
## Root Trees from IQ-Tree using Midpoint Rooting ##
library(phytools)
setwd("~/Desktop/ViralAncestral/results")
## 5'UTR Trees
## MUSCLE Only under GTR+F+I+G4
muscle_gtr_5utr_nt_ires1 <- read.tree("./5UTR_Trees/GTR+F+I+G4/ML_Tree/5UTR_MUSCLE_ires1_GTR_NT.fasta.treefile")
muscle_gtr_5utr_nt_ires2 <- read.tree("./5UTR_Trees/GTR+F+I+G4/ML_Tree/5UTR_MUSCLE_ires2_GTR_NT.fasta.treefile")
muscle_gtr_5utr_nt_ires3 <- read.tree("./5UTR_Trees/GTR+F+I+G4/ML_Tree/5UTR_MUSCLE_ires3_GTR_NT.fasta.treefile")
muscle_gtr_5utr_nt_ires1_rooted <- midpoint.root(muscle_gtr_5utr_nt_ires1, node.lables = "support")
muscle_gtr_5utr_nt_ires2_rooted <- midpoint.root(muscle_gtr_5utr_nt_ires2, node.lables = "support")
muscle_gtr_5utr_nt_ires3_rooted <- midpoint.root(muscle_gtr_5utr_nt_ires3, node.lables = "support")
write.tree(muscle_gtr_5utr_nt_ires1_rooted, file="./Rooted_Trees/5UTR/muscle_gtr_5utr_nt_ires1_rooted.treefile")
write.tree(muscle_gtr_5utr_nt_ires2_rooted, file="./Rooted_Trees/5UTR/muscle_gtr_5utr_nt_ires2_rooted.treefile")
write.tree(muscle_gtr_5utr_nt_ires3_rooted, file="./Rooted_Trees/5UTR/muscle_gtr_5utr_nt_ires3_rooted.treefile")
## MUSCLE Only under Extended Model Finder
muscle_sym_5utr_nt_ires1 <- read.tree("./5UTR_Trees/MFP/ML_Tree/5UTR_MUSCLE_ires1_MFP_NT.fasta.treefile")
muscle_tpm3u_5utr_nt_ires2 <- read.tree("./5UTR_Trees/MFP/ML_Tree/5UTR_MUSCLE_ires2_MFP_NT.fasta.treefile")
muscle_tn_5utr_nt_ires3 <- read.tree("./5UTR_Trees/MFP/ML_Tree/5UTR_MUSCLE_ires3_MFP_NT.fasta.treefile")
muscle_sym_5utr_nt_ires1_rooted  <- midpoint.root(muscle_sym_5utr_nt_ires1, node.lables = "support")
muscle_tpm3u_5utr_nt_ires2_rooted <- midpoint.root(muscle_tpm3u_5utr_nt_ires2, node.lables = "support")
muscle_tn_5utr_nt_ires3_rooted <- midpoint.root(muscle_tn_5utr_nt_ires3, node.labels = "support")
write.tree(muscle_sym_5utr_nt_ires1_rooted, file="./Rooted_Trees/5UTR/muscle_sym_5utr_nt_ires1_rooted.treefile")
write.tree(muscle_tpm3u_5utr_nt_ires2_rooted, file="./Rooted_Trees/5UTR/muscle_tpm3u_5utr_nt_ires2_rooted.treefile")
write.tree(muscle_tn_5utr_nt_ires3_rooted, file="./Rooted_Trees/5UTR/muscle_tn_5utr_nt_ires3_rooted.treefile")
## MUSCLE + HmmCleaner alignment under GTR+F+I+G4
muscle_hmm_gtr_5utr_nt_ires1 <- read.tree("./5UTR_Trees/GTR+F+I+G4/ML_Tree/5UTR_MUSCLE_ires1_GTR_NT_hmm.fasta.treefile")
muscle_hmm_gtr_5utr_nt_ires2 <- read.tree("./5UTR_Trees/GTR+F+I+G4/ML_Tree/5UTR_MUSCLE_ires2_GTR_NT_hmm.fasta.treefile")
muscle_hmm_gtr_5utr_nt_ires3 <- read.tree("./5UTR_Trees/GTR+F+I+G4/ML_Tree/5UTR_MUSCLE_ires3_GTR_NT_hmm.fasta.treefile")
muscle_hmm_gtr_5utr_nt_ires1_rooted <- midpoint.root(muscle_hmm_gtr_5utr_nt_ires1, node.lables = "support")
muscle_hmm_gtr_5utr_nt_ires2_rooted <- midpoint.root(muscle_hmm_gtr_5utr_nt_ires2, node.lables = "support")
muscle_hmm_gtr_5utr_nt_ires3_rooted <- midpoint.root(muscle_hmm_gtr_5utr_nt_ires3, node.lables = "support")
write.tree(muscle_hmm_gtr_5utr_nt_ires1_rooted, file="./Rooted_Trees/5UTR/muscle_hmm_gtr_5utr_nt_ires1_rooted.treefile")
write.tree(muscle_hmm_gtr_5utr_nt_ires2_rooted, file="./Rooted_Trees/5UTR/muscle_hmm_gtr_5utr_nt_ires2_rooted.treefile")
write.tree(muscle_hmm_gtr_5utr_nt_ires3_rooted, file="./Rooted_Trees/5UTR/muscle_hmm_gtr_5utr_nt_ires3_rooted.treefile")
## MUSCLE + HmmCleaner alignment under Extended Model Finder
muscle_hmm_sym_5utr_nt_ires1 <- read.tree("./5UTR_Trees/MFP/ML_Tree/5UTR_MUSCLE_ires1_MFP_NT_hmm.fasta.treefile")
muscle_hmm_tim3e_5utr_nt_ires2 <- read.tree("./5UTR_Trees/MFP/ML_Tree/5UTR_MUSCLE_ires2_MFP_NT_hmm.fasta.treefile")
muscle_hmm_hky_5utr_nt_ires3 <- read.tree("./5UTR_Trees/MFP/ML_Tree/5UTR_MUSCLE_ires3_MFP_NT_hmm.fasta.treefile")
muscle_hmm_sym_5utr_nt_ires1_rooted  <- midpoint.root(muscle_hmm_sym_5utr_nt_ires1, node.lables = "support")
muscle_hmm_tim3e_5utr_nt_ires2_rooted <- midpoint.root(muscle_hmm_tim3e_5utr_nt_ires2, node.lables = "support")
muscle_hmm_hky_5utr_nt_ires3_rooted <- midpoint.root(muscle_hmm_hky_5utr_nt_ires3, node.labels = "support")
write.tree(muscle_hmm_sym_5utr_nt_ires1_rooted, file="./Rooted_Trees/5UTR/muscle_hmm_sym_5utr_nt_ires1_rooted.treefile")
write.tree(muscle_hmm_tim3e_5utr_nt_ires2_rooted, file="./Rooted_Trees/5UTR/muscle_hmm_tim3e_5utr_nt_ires2_rooted.treefile")
write.tree(muscle_hmm_hky_5utr_nt_ires3_rooted, file="./Rooted_Trees/5UTR/muscle_hmm_hky_5utr_nt_ires3_rooted.treefile")
3*(5+12)
muscle_gtr_rep_nt_ires1 <- read.tree("./Replicase_Trees/GTR+F+I+G4/ML_Tree/Rep_MUSCLE_ires1_GTR_NT.fasta.treefile")
muscle_gtr_rep_nt_ires2 <- read.tree("./Replicase_Trees/GTR+F+I+G4/ML_Tree/Rep_MUSCLE_ires2_GTR_NT.fasta.treefile")
muscle_gtr_rep_nt_ires3 <- read.tree("./Replicase_Trees/GTR+F+I+G4/ML_Tree/Rep_MUSCLE_ires3_GTR_NT.fasta.treefile")
muscle_gtr_rep_nt_ires1_rooted <- midpoint.root(muscle_gtr_rep_nt_ires1, node.lables = "support")
muscle_gtr_rep_nt_ires2_rooted <- midpoint.root(muscle_gtr_rep_nt_ires2, node.lables = "support")
muscle_gtr_rep_nt_ires3_rooted <- midpoint.root(muscle_gtr_rep_nt_ires3, node.lables = "support")
write.tree(muscle_gtr_rep_nt_ires1_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_gtr_rep_nt_ires1_rooted.treefile")
write.tree(muscle_gtr_rep_nt_ires2_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_gtr_rep_nt_ires2_rooted.treefile")
write.tree(muscle_gtr_rep_nt_ires3_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_gtr_rep_nt_ires3_rooted.treefile")
## MUSCLE NT only alignment under Extended Model Finder --> only need to do for IRES 3
muscle_tpm2u_rep_nt_ires3 <- read.tree("./Replicase_Trees/GTR+F+I+G4/ML_Tree/Rep_MUSCLE_ires3_MFP_NT.fasta.treefile")
## MUSCLE NT only alignment under Extended Model Finder --> only need to do for IRES 3
muscle_tpm2u_rep_nt_ires3 <- read.tree("./Replicase_Trees/MFP/ML_Tree/Rep_MUSCLE_ires3_MFP_NT.fasta.treefile")
muscle_tpm2u_rep_nt_ires3_rooted <- midpoint.root(muscle_tpm2u_rep_nt_ires3, node.lables = "support")
write.tree(muscle_tpm2u_rep_nt_ires3_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_tpm2u_rep_nt_ires3_rooted.treefile")
muscle_hmm_gtr_rep_nt_ires1 <- read.tree("./Replicase_Trees/GTR+F+I+G4/ML_Tree/Rep_MUSCLE_ires1_GTR_NT_hmm.fasta.treefile")
muscle_hmm_gtr_rep_nt_ires2 <- read.tree("./Replicase_Trees/GTR+F+I+G4/ML_Tree/Rep_MUSCLE_ires2_GTR_NT_hmm.fasta.treefile")
muscle_hmm_gtr_rep_nt_ires3 <- read.tree("./Replicase_Trees/GTR+F+I+G4/ML_Tree/Rep_MUSCLE_ires3_GTR_NT_hmm.fasta.treefile")
muscle_hmm_gtr_rep_nt_ires1_rooted <- midpoint.root(muscle_hmm_gtr_rep_nt_ires1, node.lables = "support")
muscle_hmm_gtr_rep_nt_ires2_rooted <- midpoint.root(muscle_hmm_gtr_rep_nt_ires2, node.lables = "support")
muscle_hmm_gtr_rep_nt_ires3_rooted <- midpoint.root(muscle_hmm_gtr_rep_nt_ires3, node.lables = "support")
write.tree(muscle_hmm_gtr_rep_nt_ires1_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_hmm_gtr_rep_nt_ires1_rooted.treefile")
write.tree(muscle_hmm_gtr_rep_nt_ires2_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_hmm_gtr_rep_nt_ires2_rooted.treefile")
write.tree(muscle_hmm_gtr_rep_nt_ires3_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_hmm_gtr_rep_nt_ires3_rooted.treefile")
## MUSCLE NT + HmmCleaner alignment under Extended Model Finder --> Only need to do IRES 3
muscle_hmm_tpm2u_rep_nt_ires3 <- read.tree("./Replicase_Trees/MFP/ML_Tree/Rep_MUSCLE_ires3_MFP_NT_hmm.fasta.treefile")
muscle_hmm_tpm2u_rep_nt_ires3_rooted <- midpoint.root(muscle_hmm_tpm2u_rep_nt_ires3, node.lables = "support")
write.tree(muscle_hmm_tpm2u_rep_nt_ires3_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_hmm_tpm2u_rep_nt_ires3_rooted.treefile")
## MUSCLE AA only alignment under LG+F+I+G4
muscle_lg_rep_aa_ires1 <- read.tree("./Replicase_Trees/LG+F+I+G4/ML_Tree/Rep_MUSCLE_ires1_LG_AA.fasta.treefile")
muscle_lg_rep_aa_ires2 <- read.tree("./Replicase_Trees/LG+F+I+G4/ML_Tree/Rep_MUSCLE_ires2_LG_AA.fasta.treefile")
muscle_lg_rep_aa_ires3 <- read.tree("./Replicase_Trees/LG+F+I+G4/ML_Tree/Rep_MUSCLE_ires3_LG_AA.fasta.treefile")
muscle_lg_rep_aa_ires1_rooted <- midpoint.root(muscle_lg_rep_aa_ires1, node.lables = "support")
muscle_lg_rep_aa_ires2_rooted <- midpoint.root(muscle_lg_rep_aa_ires2, node.lables = "support")
muscle_lg_rep_aa_ires3_rooted <- midpoint.root(muscle_lg_rep_aa_ires3, node.lables = "support")
write.tree(muscle_lg_rep_aa_ires1_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_lg_rep_aa_ires1_rooted.treefile")
write.tree(muscle_lg_rep_aa_ires2_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_lg_rep_aa_ires2_rooted.treefile")
write.tree(muscle_lg_rep_aa_ires3_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_lg_rep_aa_ires3_rooted.treefile")
## MUSCLE AA only alignment under FLAVI+F+I+G4
muscle_flavi_rep_aa_ires1 <- read.tree("./Replicase_Trees/FLAVI+F+I+G4/ML_Tree/Rep_MUSCLE_ires1_FLAVI_AA.fasta.treefile")
muscle_flavi_rep_aa_ires2 <- read.tree("./Replicase_Trees/FLAVI+F+I+G4/ML_Tree/Rep_MUSCLE_ires2_FLAVI_AA.fasta.treefile")
muscle_flavi_rep_aa_ires3 <- read.tree("./Replicase_Trees/FLAVI+F+I+G4/ML_Tree/Rep_MUSCLE_ires3_FLAVI_AA.fasta.treefile")
muscle_flavi_rep_aa_ires1_rooted <- midpoint.root(muscle_flavi_rep_aa_ires1, node.lables = "support")
muscle_flavi_rep_aa_ires2_rooted <- midpoint.root(muscle_flavi_rep_aa_ires2, node.lables = "support")
muscle_flavi_rep_aa_ires3_rooted <- midpoint.root(muscle_flavi_rep_aa_ires3, node.lables = "support")
write.tree(muscle_flavi_rep_aa_ires1_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_flavi_rep_aa_ires1_rooted.treefile")
write.tree(muscle_flavi_rep_aa_ires2_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_flavi_rep_aa_ires2_rooted.treefile")
write.tree(muscle_flavi_rep_aa_ires3_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_flavi_rep_aa_ires3_rooted.treefile")
## MUSCLE AA only alignment under Extended Model Finder --> only need to do for IRES 3
muscle_blosum62_rep_aa_ires3 <- read.tree("./Replicase_Trees/MFP/ML_Tree/Rep_MUSCLE_ires3_MFP_AA.fasta.treefile")
muscle_blosum62_rep_aa_ires3_rooted <- midpoint.root(muscle_blosum62_rep_aa_ires3, node.lables = "support")
write.tree(muscle_blosum62_rep_aa_ires3_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_blosum62_rep_aa_ires3_rooted.treefile")
## MUSCLE AA + HmmCleaner alignment under LG+F+I+G4 Model
muscle_hmm_lg_rep_aa_ires1 <- read.tree("./Replicase_Trees/LG+F+I+G4/ML_Tree/Rep_MUSCLE_ires1_LG_AA_hmm.fasta.treefile")
muscle_hmm_lg_rep_aa_ires2 <- read.tree("./Replicase_Trees/LG+F+I+G4/ML_Tree/Rep_MUSCLE_ires2_LG_AA_hmm.fasta.treefile")
muscle_hmm_lg_rep_aa_ires3 <- read.tree("./Replicase_Trees/LG+F+I+G4/ML_Tree/Rep_MUSCLE_ires3_LG_AA_hmm.fasta.treefile")
muscle_hmm_lg_rep_aa_ires1_rooted <- midpoint.root(muscle_hmm_lg_rep_aa_ires1, node.lables = "support")
muscle_hmm_lg_rep_aa_ires2_rooted <- midpoint.root(muscle_hmm_lg_rep_aa_ires2, node.lables = "support")
muscle_hmm_lg_rep_aa_ires3_rooted <- midpoint.root(muscle_hmm_lg_rep_aa_ires3, node.lables = "support")
write.tree(muscle_hmm_lg_rep_aa_ires1_rooted , file="./Rooted_Trees/Replicase_Gene/muscle_hmm_lg_rep_aa_ires1_rooted .treefile")
write.tree(muscle_hmm_lg_rep_aa_ires2_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_hmm_lg_rep_aa_ires2_rooted.treefile")
write.tree(muscle_hmm_lg_rep_aa_ires3_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_hmm_lg_rep_aa_ires3_rooted.treefile")
## MUSCLE AA + HmmCleaner alignment under FLAVI+F+I+G4 Model
muscle_hmm_flavi_rep_aa_ires1 <- read.tree("./Replicase_Trees/FLAVI+F+I+G4/ML_Tree/Rep_MUSCLE_ires1_FLAVI_AA_hmm.fasta.treefile")
muscle_hmm_flavi_rep_aa_ires2 <- read.tree("./Replicase_Trees/FLAVI+F+I+G4/ML_Tree/Rep_MUSCLE_ires2_FLAVI_AA_hmm.fasta.treefile")
muscle_hmm_flavi_rep_aa_ires3 <- read.tree("./Replicase_Trees/FLAVI+F+I+G4/ML_Tree/Rep_MUSCLE_ires3_FLAVI_AA_hmm.fasta.treefile")
muscle_hmm_flavi_rep_aa_ires1_rooted <- midpoint.root(muscle_hmm_flavi_rep_aa_ires1, node.lables = "support")
muscle_hmm_flavi_rep_aa_ires2_rooted <- midpoint.root(muscle_hmm_flavi_rep_aa_ires2, node.lables = "support")
muscle_hmm_flavi_rep_aa_ires3_rooted <- midpoint.root(muscle_hmm_flavi_rep_aa_ires3, node.lables = "support")
write.tree(muscle_hmm_flavi_rep_aa_ires1_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_hmm_flavi_rep_aa_ires1_rooted.treefile")
write.tree(muscle_hmm_flavi_rep_aa_ires2_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_hmm_flavi_rep_aa_ires2_rooted.treefile")
write.tree(muscle_hmm_flavi_rep_aa_ires3_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_hmm_flavi_rep_aa_ires3_rooted.treefile")
## MUSCLE AA + HmmCleaner alignment under Extended Model Finder --> only need to do IRES 3
muscle_hmm_blosum62_rep_aa_ires3 <- read.tree("./Replicase_Trees/MFP/ML_Tree/Rep_MUSCLE_ires3_MFP_AA_hmm.fasta.treefile")
muscle_hmm_blosum62_rep_aa_ires3_rooted <- midpoint.root(muscle_hmm_blosum62_rep_aa_ires3, node.lables = "support")
write.tree(muscle_hmm_blosum62_rep_aa_ires3_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_hmm_blosum62_rep_aa_ires3_rooted.treefile")
## Root Trees from IQ-Tree using Midpoint Rooting ##
library(phytools)
setwd("~/Desktop/ViralAncestral/results")
## 5'UTR Trees
## MUSCLE only alignment under GTR+F+I+G4
muscle_gtr_5utr_nt_ires1 <- read.tree("./5UTR_Trees/GTR+F+I+G4/ML_Tree/5UTR_MUSCLE_ires1_GTR_NT.fasta.treefile")
muscle_gtr_5utr_nt_ires2 <- read.tree("./5UTR_Trees/GTR+F+I+G4/ML_Tree/5UTR_MUSCLE_ires2_GTR_NT.fasta.treefile")
muscle_gtr_5utr_nt_ires3 <- read.tree("./5UTR_Trees/GTR+F+I+G4/ML_Tree/5UTR_MUSCLE_ires3_GTR_NT.fasta.treefile")
muscle_gtr_5utr_nt_ires1_rooted <- midpoint.root(muscle_gtr_5utr_nt_ires1, node.lables = "support")
muscle_gtr_5utr_nt_ires2_rooted <- midpoint.root(muscle_gtr_5utr_nt_ires2, node.lables = "support")
muscle_gtr_5utr_nt_ires3_rooted <- midpoint.root(muscle_gtr_5utr_nt_ires3, node.lables = "support")
write.tree(muscle_gtr_5utr_nt_ires1_rooted, file="./Rooted_Trees/5UTR/muscle_gtr_5utr_nt_ires1_rooted.treefile")
write.tree(muscle_gtr_5utr_nt_ires2_rooted, file="./Rooted_Trees/5UTR/muscle_gtr_5utr_nt_ires2_rooted.treefile")
write.tree(muscle_gtr_5utr_nt_ires3_rooted, file="./Rooted_Trees/5UTR/muscle_gtr_5utr_nt_ires3_rooted.treefile")
## MUSCLE only alignment under Extended Model Finder
muscle_sym_5utr_nt_ires1 <- read.tree("./5UTR_Trees/MFP/ML_Tree/5UTR_MUSCLE_ires1_MFP_NT.fasta.treefile")
muscle_tpm3u_5utr_nt_ires2 <- read.tree("./5UTR_Trees/MFP/ML_Tree/5UTR_MUSCLE_ires2_MFP_NT.fasta.treefile")
muscle_tn_5utr_nt_ires3 <- read.tree("./5UTR_Trees/MFP/ML_Tree/5UTR_MUSCLE_ires3_MFP_NT.fasta.treefile")
muscle_sym_5utr_nt_ires1_rooted  <- midpoint.root(muscle_sym_5utr_nt_ires1, node.lables = "support")
muscle_tpm3u_5utr_nt_ires2_rooted <- midpoint.root(muscle_tpm3u_5utr_nt_ires2, node.lables = "support")
muscle_tn_5utr_nt_ires3_rooted <- midpoint.root(muscle_tn_5utr_nt_ires3, node.labels = "support")
write.tree(muscle_sym_5utr_nt_ires1_rooted, file="./Rooted_Trees/5UTR/muscle_sym_5utr_nt_ires1_rooted.treefile")
write.tree(muscle_tpm3u_5utr_nt_ires2_rooted, file="./Rooted_Trees/5UTR/muscle_tpm3u_5utr_nt_ires2_rooted.treefile")
write.tree(muscle_tn_5utr_nt_ires3_rooted, file="./Rooted_Trees/5UTR/muscle_tn_5utr_nt_ires3_rooted.treefile")
## MUSCLE + HmmCleaner alignment under GTR+F+I+G4
muscle_hmm_gtr_5utr_nt_ires1 <- read.tree("./5UTR_Trees/GTR+F+I+G4/ML_Tree/5UTR_MUSCLE_ires1_GTR_NT_hmm.fasta.treefile")
muscle_hmm_gtr_5utr_nt_ires2 <- read.tree("./5UTR_Trees/GTR+F+I+G4/ML_Tree/5UTR_MUSCLE_ires2_GTR_NT_hmm.fasta.treefile")
muscle_hmm_gtr_5utr_nt_ires3 <- read.tree("./5UTR_Trees/GTR+F+I+G4/ML_Tree/5UTR_MUSCLE_ires3_GTR_NT_hmm.fasta.treefile")
muscle_hmm_gtr_5utr_nt_ires1_rooted <- midpoint.root(muscle_hmm_gtr_5utr_nt_ires1, node.lables = "support")
muscle_hmm_gtr_5utr_nt_ires2_rooted <- midpoint.root(muscle_hmm_gtr_5utr_nt_ires2, node.lables = "support")
muscle_hmm_gtr_5utr_nt_ires3_rooted <- midpoint.root(muscle_hmm_gtr_5utr_nt_ires3, node.lables = "support")
write.tree(muscle_hmm_gtr_5utr_nt_ires1_rooted, file="./Rooted_Trees/5UTR/muscle_hmm_gtr_5utr_nt_ires1_rooted.treefile")
write.tree(muscle_hmm_gtr_5utr_nt_ires2_rooted, file="./Rooted_Trees/5UTR/muscle_hmm_gtr_5utr_nt_ires2_rooted.treefile")
write.tree(muscle_hmm_gtr_5utr_nt_ires3_rooted, file="./Rooted_Trees/5UTR/muscle_hmm_gtr_5utr_nt_ires3_rooted.treefile")
## MUSCLE + HmmCleaner alignment under Extended Model Finder
muscle_hmm_sym_5utr_nt_ires1 <- read.tree("./5UTR_Trees/MFP/ML_Tree/5UTR_MUSCLE_ires1_MFP_NT_hmm.fasta.treefile")
muscle_hmm_tim3e_5utr_nt_ires2 <- read.tree("./5UTR_Trees/MFP/ML_Tree/5UTR_MUSCLE_ires2_MFP_NT_hmm.fasta.treefile")
muscle_hmm_hky_5utr_nt_ires3 <- read.tree("./5UTR_Trees/MFP/ML_Tree/5UTR_MUSCLE_ires3_MFP_NT_hmm.fasta.treefile")
muscle_hmm_sym_5utr_nt_ires1_rooted  <- midpoint.root(muscle_hmm_sym_5utr_nt_ires1, node.lables = "support")
muscle_hmm_tim3e_5utr_nt_ires2_rooted <- midpoint.root(muscle_hmm_tim3e_5utr_nt_ires2, node.lables = "support")
muscle_hmm_hky_5utr_nt_ires3_rooted <- midpoint.root(muscle_hmm_hky_5utr_nt_ires3, node.labels = "support")
write.tree(muscle_hmm_sym_5utr_nt_ires1_rooted, file="./Rooted_Trees/5UTR/muscle_hmm_sym_5utr_nt_ires1_rooted.treefile")
write.tree(muscle_hmm_tim3e_5utr_nt_ires2_rooted, file="./Rooted_Trees/5UTR/muscle_hmm_tim3e_5utr_nt_ires2_rooted.treefile")
write.tree(muscle_hmm_hky_5utr_nt_ires3_rooted, file="./Rooted_Trees/5UTR/muscle_hmm_hky_5utr_nt_ires3_rooted.treefile")
## Replicase Trees ##
## MUSCLE NT only alignment under GTR+F+I+G4
muscle_gtr_rep_nt_ires1 <- read.tree("./Replicase_Trees/GTR+F+I+G4/ML_Tree/Rep_MUSCLE_ires1_GTR_NT.fasta.treefile")
muscle_gtr_rep_nt_ires2 <- read.tree("./Replicase_Trees/GTR+F+I+G4/ML_Tree/Rep_MUSCLE_ires2_GTR_NT.fasta.treefile")
muscle_gtr_rep_nt_ires3 <- read.tree("./Replicase_Trees/GTR+F+I+G4/ML_Tree/Rep_MUSCLE_ires3_GTR_NT.fasta.treefile")
muscle_gtr_rep_nt_ires1_rooted <- midpoint.root(muscle_gtr_rep_nt_ires1, node.lables = "support")
muscle_gtr_rep_nt_ires2_rooted <- midpoint.root(muscle_gtr_rep_nt_ires2, node.lables = "support")
muscle_gtr_rep_nt_ires3_rooted <- midpoint.root(muscle_gtr_rep_nt_ires3, node.lables = "support")
write.tree(muscle_gtr_rep_nt_ires1_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_gtr_rep_nt_ires1_rooted.treefile")
write.tree(muscle_gtr_rep_nt_ires2_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_gtr_rep_nt_ires2_rooted.treefile")
write.tree(muscle_gtr_rep_nt_ires3_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_gtr_rep_nt_ires3_rooted.treefile")
## MUSCLE NT only alignment under Extended Model Finder --> only need to do for IRES 3
muscle_tpm2u_rep_nt_ires3 <- read.tree("./Replicase_Trees/MFP/ML_Tree/Rep_MUSCLE_ires3_MFP_NT.fasta.treefile")
muscle_tpm2u_rep_nt_ires3_rooted <- midpoint.root(muscle_tpm2u_rep_nt_ires3, node.lables = "support")
write.tree(muscle_tpm2u_rep_nt_ires3_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_tpm2u_rep_nt_ires3_rooted.treefile")
## MUSCLE AA only alignment under LG+F+I+G4
muscle_lg_rep_aa_ires1 <- read.tree("./Replicase_Trees/LG+F+I+G4/ML_Tree/Rep_MUSCLE_ires1_LG_AA.fasta.treefile")
muscle_lg_rep_aa_ires2 <- read.tree("./Replicase_Trees/LG+F+I+G4/ML_Tree/Rep_MUSCLE_ires2_LG_AA.fasta.treefile")
muscle_lg_rep_aa_ires3 <- read.tree("./Replicase_Trees/LG+F+I+G4/ML_Tree/Rep_MUSCLE_ires3_LG_AA.fasta.treefile")
muscle_lg_rep_aa_ires1_rooted <- midpoint.root(muscle_lg_rep_aa_ires1, node.lables = "support")
muscle_lg_rep_aa_ires2_rooted <- midpoint.root(muscle_lg_rep_aa_ires2, node.lables = "support")
muscle_lg_rep_aa_ires3_rooted <- midpoint.root(muscle_lg_rep_aa_ires3, node.lables = "support")
write.tree(muscle_lg_rep_aa_ires1_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_lg_rep_aa_ires1_rooted.treefile")
write.tree(muscle_lg_rep_aa_ires2_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_lg_rep_aa_ires2_rooted.treefile")
write.tree(muscle_lg_rep_aa_ires3_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_lg_rep_aa_ires3_rooted.treefile")
## MUSCLE AA only alignment under FLAVI+F+I+G4
muscle_flavi_rep_aa_ires1 <- read.tree("./Replicase_Trees/FLAVI+F+I+G4/ML_Tree/Rep_MUSCLE_ires1_FLAVI_AA.fasta.treefile")
muscle_flavi_rep_aa_ires2 <- read.tree("./Replicase_Trees/FLAVI+F+I+G4/ML_Tree/Rep_MUSCLE_ires2_FLAVI_AA.fasta.treefile")
muscle_flavi_rep_aa_ires3 <- read.tree("./Replicase_Trees/FLAVI+F+I+G4/ML_Tree/Rep_MUSCLE_ires3_FLAVI_AA.fasta.treefile")
muscle_flavi_rep_aa_ires1_rooted <- midpoint.root(muscle_flavi_rep_aa_ires1, node.lables = "support")
muscle_flavi_rep_aa_ires2_rooted <- midpoint.root(muscle_flavi_rep_aa_ires2, node.lables = "support")
muscle_flavi_rep_aa_ires3_rooted <- midpoint.root(muscle_flavi_rep_aa_ires3, node.lables = "support")
write.tree(muscle_flavi_rep_aa_ires1_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_flavi_rep_aa_ires1_rooted.treefile")
write.tree(muscle_flavi_rep_aa_ires2_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_flavi_rep_aa_ires2_rooted.treefile")
write.tree(muscle_flavi_rep_aa_ires3_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_flavi_rep_aa_ires3_rooted.treefile")
## MUSCLE AA only alignment under Extended Model Finder --> only need to do for IRES 3
muscle_blosum62_rep_aa_ires3 <- read.tree("./Replicase_Trees/MFP/ML_Tree/Rep_MUSCLE_ires3_MFP_AA.fasta.treefile")
muscle_blosum62_rep_aa_ires3_rooted <- midpoint.root(muscle_blosum62_rep_aa_ires3, node.lables = "support")
write.tree(muscle_blosum62_rep_aa_ires3_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_blosum62_rep_aa_ires3_rooted.treefile")
## MUSCLE NT + HmmCleaner alignment under GTR+F+I+G4 Model
muscle_hmm_gtr_rep_nt_ires1 <- read.tree("./Replicase_Trees/GTR+F+I+G4/ML_Tree/Rep_MUSCLE_ires1_GTR_NT_hmm.fasta.treefile")
muscle_hmm_gtr_rep_nt_ires2 <- read.tree("./Replicase_Trees/GTR+F+I+G4/ML_Tree/Rep_MUSCLE_ires2_GTR_NT_hmm.fasta.treefile")
muscle_hmm_gtr_rep_nt_ires3 <- read.tree("./Replicase_Trees/GTR+F+I+G4/ML_Tree/Rep_MUSCLE_ires3_GTR_NT_hmm.fasta.treefile")
muscle_hmm_gtr_rep_nt_ires1_rooted <- midpoint.root(muscle_hmm_gtr_rep_nt_ires1, node.lables = "support")
muscle_hmm_gtr_rep_nt_ires2_rooted <- midpoint.root(muscle_hmm_gtr_rep_nt_ires2, node.lables = "support")
muscle_hmm_gtr_rep_nt_ires3_rooted <- midpoint.root(muscle_hmm_gtr_rep_nt_ires3, node.lables = "support")
write.tree(muscle_hmm_gtr_rep_nt_ires1_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_hmm_gtr_rep_nt_ires1_rooted.treefile")
write.tree(muscle_hmm_gtr_rep_nt_ires2_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_hmm_gtr_rep_nt_ires2_rooted.treefile")
write.tree(muscle_hmm_gtr_rep_nt_ires3_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_hmm_gtr_rep_nt_ires3_rooted.treefile")
## MUSCLE NT + HmmCleaner alignment under Extended Model Finder --> Only need to do IRES 3
muscle_hmm_tpm2u_rep_nt_ires3 <- read.tree("./Replicase_Trees/MFP/ML_Tree/Rep_MUSCLE_ires3_MFP_NT_hmm.fasta.treefile")
muscle_hmm_tpm2u_rep_nt_ires3_rooted <- midpoint.root(muscle_hmm_tpm2u_rep_nt_ires3, node.lables = "support")
write.tree(muscle_hmm_tpm2u_rep_nt_ires3_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_hmm_tpm2u_rep_nt_ires3_rooted.treefile")
## MUSCLE AA + HmmCleaner alignment under LG+F+I+G4 Model
muscle_hmm_lg_rep_aa_ires1 <- read.tree("./Replicase_Trees/LG+F+I+G4/ML_Tree/Rep_MUSCLE_ires1_LG_AA_hmm.fasta.treefile")
muscle_hmm_lg_rep_aa_ires2 <- read.tree("./Replicase_Trees/LG+F+I+G4/ML_Tree/Rep_MUSCLE_ires2_LG_AA_hmm.fasta.treefile")
muscle_hmm_lg_rep_aa_ires3 <- read.tree("./Replicase_Trees/LG+F+I+G4/ML_Tree/Rep_MUSCLE_ires3_LG_AA_hmm.fasta.treefile")
muscle_hmm_lg_rep_aa_ires1_rooted <- midpoint.root(muscle_hmm_lg_rep_aa_ires1, node.lables = "support")
muscle_hmm_lg_rep_aa_ires2_rooted <- midpoint.root(muscle_hmm_lg_rep_aa_ires2, node.lables = "support")
muscle_hmm_lg_rep_aa_ires3_rooted <- midpoint.root(muscle_hmm_lg_rep_aa_ires3, node.lables = "support")
write.tree(muscle_hmm_lg_rep_aa_ires1_rooted , file="./Rooted_Trees/Replicase_Gene/muscle_hmm_lg_rep_aa_ires1_rooted .treefile")
write.tree(muscle_hmm_lg_rep_aa_ires2_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_hmm_lg_rep_aa_ires2_rooted.treefile")
write.tree(muscle_hmm_lg_rep_aa_ires3_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_hmm_lg_rep_aa_ires3_rooted.treefile")
## MUSCLE AA + HmmCleaner alignment under FLAVI+F+I+G4 Model
muscle_hmm_flavi_rep_aa_ires1 <- read.tree("./Replicase_Trees/FLAVI+F+I+G4/ML_Tree/Rep_MUSCLE_ires1_FLAVI_AA_hmm.fasta.treefile")
muscle_hmm_flavi_rep_aa_ires2 <- read.tree("./Replicase_Trees/FLAVI+F+I+G4/ML_Tree/Rep_MUSCLE_ires2_FLAVI_AA_hmm.fasta.treefile")
muscle_hmm_flavi_rep_aa_ires3 <- read.tree("./Replicase_Trees/FLAVI+F+I+G4/ML_Tree/Rep_MUSCLE_ires3_FLAVI_AA_hmm.fasta.treefile")
muscle_hmm_flavi_rep_aa_ires1_rooted <- midpoint.root(muscle_hmm_flavi_rep_aa_ires1, node.lables = "support")
muscle_hmm_flavi_rep_aa_ires2_rooted <- midpoint.root(muscle_hmm_flavi_rep_aa_ires2, node.lables = "support")
muscle_hmm_flavi_rep_aa_ires3_rooted <- midpoint.root(muscle_hmm_flavi_rep_aa_ires3, node.lables = "support")
write.tree(muscle_hmm_flavi_rep_aa_ires1_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_hmm_flavi_rep_aa_ires1_rooted.treefile")
write.tree(muscle_hmm_flavi_rep_aa_ires2_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_hmm_flavi_rep_aa_ires2_rooted.treefile")
write.tree(muscle_hmm_flavi_rep_aa_ires3_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_hmm_flavi_rep_aa_ires3_rooted.treefile")
## MUSCLE AA + HmmCleaner alignment under Extended Model Finder --> only need to do IRES 3
muscle_hmm_blosum62_rep_aa_ires3 <- read.tree("./Replicase_Trees/MFP/ML_Tree/Rep_MUSCLE_ires3_MFP_AA_hmm.fasta.treefile")
muscle_hmm_blosum62_rep_aa_ires3_rooted <- midpoint.root(muscle_hmm_blosum62_rep_aa_ires3, node.lables = "support")
write.tree(muscle_hmm_blosum62_rep_aa_ires3_rooted, file="./Rooted_Trees/Replicase_Gene/muscle_hmm_blosum62_rep_aa_ires3_rooted.treefile")
first <- read.fasta("~/Desktop/ViralAncestral/results/raxml-ng/data/5UTR_MUSCLE_ires1_NT_hmm.fasta.raxml.ancestralStates")
first <- read.table("~/Desktop/ViralAncestral/results/raxml-ng/data/5UTR_MUSCLE_ires1_NT_hmm.fasta.raxml.ancestralStates")
View(first)
colnames(first) <- c("seq.name", "seq.text")
first$seq.name <- sprintf(">%d", seq_len(nrow(first)))
View(first)
first$seq.name <- sprintf(">%d", seq_len(nrow(first)))
dat2fasta(first, "Users/haileylouw/Desktop/first.fasta")
dat2fasta(first, "/Users/haileylouw/Desktop/first.fasta")
first <- read.fasta("/Users/haileylouw/Desktop/first.fasta")
View(first)
first <- read.table("~/Desktop/ViralAncestral/results/raxml-ng/data/5UTR_MUSCLE_ires1_NT_hmm.fasta.raxml.ancestralStates")
colnames(first) <- c("seq.name", "seq.text")
first[20,1] <- 1
View(first)
first$seq.name <- sprintf(">%d", first$seq.name)
View(first)
dat2fasta(first, "/Users/haileylouw/Desktop/first.fasta")
first <- read.fasta("/Users/haileylouw/Desktop/first.fasta")
first <- read.table("~/Desktop/ViralAncestral/results/raxml-ng/data/5UTR_MUSCLE_ires1_NT_hmm.fasta.raxml.ancestralStates")
colnames(first) <- c("seq.name", "seq.text")
first[20,1] <- 1
## output file is a table, with ancestral sequence labeled as NA
first <- read.table("~/Desktop/ViralAncestral/results/raxml-ng/data/5UTR_MUSCLE_ires1_NT_hmm.fasta.raxml.ancestralStates")
View(first)
## output file is a table, with ancestral sequence labeled as NA
## We convert it to a FASTA file and insert "1" into the NA entry to indicate its place in ancestry
fiveUTR_muscle_ires1_nt_hmm_sym_ancestral <- read.table("./data/5UTR_IRES1_MUSCLE_Trimmed_Ancestral/SYM+G4/5UTR_MUSCLE_ires1_NT_hmm.fasta.raxml.ancestralStates")
## output file is a table, with ancestral sequence labeled as NA
## We convert it to a FASTA file and insert "1" into the NA entry to indicate its place in ancestry
fiveUTR_muscle_ires1_nt_hmm_sym_ancestral <- read.table("./data/5UTR_IRES1_MUSCLE_Trimmed_Ancestral/SYM+G4/5UTR_MUSCLE_ires1_NT_hmm.fasta.raxml.ancestralStates")
## output file is a table, with ancestral sequence labeled as NA
## We convert it to a FASTA file and insert "1" into the NA entry to indicate its place in ancestry
setwd("/Users/haileylouw/Desktop/ViralAncestral/results/raxml-ng")
fiveUTR_muscle_ires1_nt_hmm_sym_ancestral <- read.table("./data/5UTR_IRES1_MUSCLE_Trimmed_Ancestral/SYM+G4/5UTR_MUSCLE_ires1_NT_hmm.fasta.raxml.ancestralStates")
colnames(fiveUTR_muscle_ires1_nt_hmm_sym_ancestral) <- c("seq.name", "seq.text")
fiveUTR_muscle_ires1_nt_hmm_sym_ancestral[20,1] <- 1
View(fiveUTR_muscle_ires1_nt_hmm_sym_ancestral)
## Write to directory
dat2fasta(fiveUTR_muscle_ires1_nt_hmm_sym_ancestral, "./data/5UTR_IRES1_MUSCLE_Trimmed_Ancestral/SYM+G4/5UTR_MUSCLE_ires1_NT_hmm_ancestral.fasta")
## Write to directory
dat2fasta(fiveUTR_muscle_ires1_nt_hmm_sym_ancestral, "./data/5UTR_IRES1_MUSCLE_Trimmed_Ancestral/SYM+G4/fiveUTR_muscle_ires1_nt_hmm_sym_ancestral.fasta")
fiveUTR_muscle_ires1_nt_hmm_gtr_ancestral <- read.table("./data/5UTR_IRES1_MUSCLE_Trimmed_Ancestral/GTR+I+G4/5UTR_MUSCLE_ires1_NT_hmm.fasta.raxml.ancestralStates")
View(fiveUTR_muscle_ires1_nt_hmm_gtr_ancestral)
colnames(fiveUTR_muscle_ires1_nt_hmm_gtr_ancestral) <- c("seq.name", "seq.text")
View(fiveUTR_muscle_ires1_nt_hmm_gtr_ancestral)
fiveUTR_muscle_ires1_nt_hmm_gtr_ancestral[20,1] <- 1
## Write to directory
dat2fasta(fiveUTR_muscle_ires1_nt_hmm_gtr_ancestral, "./data/5UTR_IRES1_MUSCLE_Trimmed_Ancestral/GTR+I+G4/fiveUTR_muscle_ires1_nt_hmm_gtr_ancestral.fasta")
knitr::opts_chunk$set(echo = TRUE)
setwd("/Users/haileylouw/Desktop/ViralAncestral/results/raxml-ng")
fiveUTR_muscle_ires1_nt_sym_ancestral <- read.table("./data/5UTR_IRES1_MUSCLE_Ancestral/SYM+G4/5UTR_MUSCLE_ires1_NT.fasta.raxml.ancestralStates")
View(fiveUTR_muscle_ires1_nt_hmm_gtr_ancestral)
View(fiveUTR_muscle_ires1_nt_sym_ancestral)
colnames(fiveUTR_muscle_ires1_nt_sym_ancestral) <- c("seq.name", "seq.text")
fiveUTR_muscle_ires1_nt_sym_ancestral[20,1] <- 1
## Write to directory
dat2fasta(fiveUTR_muscle_ires1_nt_sym_ancestral, "./data/5UTR_IRES1_MUSCLE_Ancestral/SYM+G4/fiveUTR_muscle_ires1_nt_sym_ancestral.fasta")
fiveUTR_muscle_ires1_nt_gtr_ancestral <- read.table("./data/5UTR_IRES1_MUSCLE_Ancestral/GTR+I+G4/5UTR_MUSCLE_ires1_NT.fasta.raxml.ancestralStates")
colnames(fiveUTR_muscle_ires1_nt_gtr_ancestral) <- c("seq.name", "seq.text")
fiveUTR_muscle_ires1_nt_gtr_ancestral[20,1] <- 1
## Write to directory
dat2fasta(fiveUTR_muscle_ires1_nt_gtr_ancestral, "./data/5UTR_IRES1_MUSCLE_Ancestral/GTR+I+G4/fiveUTR_muscle_ires1_nt_gtr_ancestral.fasta")
fiveUTR_muscle_ires2_nt_hmm_gtr_ancestral <- read.table("./data/5UTR_IRES2_MUSCLE_Trimmed_Ancestral/GTR+I+G4/5UTR_MUSCLE_ires2_NT_hmm.fasta.raxml.ancestralStates")
colnames(fiveUTR_muscle_ires2_nt_hmm_gtr_ancestral) <- c("seq.name", "seq.text")
fiveUTR_muscle_ires2_nt_hmm_gtr_ancestral[20,1] <- 1
View(fiveUTR_muscle_ires2_nt_hmm_gtr_ancestral)
fiveUTR_muscle_ires2_nt_hmm_gtr_ancestral <- read.table("./data/5UTR_IRES2_MUSCLE_Trimmed_Ancestral/GTR+I+G4/5UTR_MUSCLE_ires2_NT_hmm.fasta.raxml.ancestralStates")
colnames(fiveUTR_muscle_ires2_nt_hmm_gtr_ancestral) <- c("seq.name", "seq.text")
View(fiveUTR_muscle_ires2_nt_hmm_gtr_ancestral)
## Write to directory
dat2fasta(fiveUTR_muscle_ires2_nt_hmm_gtr_ancestral, "./data/5UTR_IRES2_MUSCLE_Trimmed_Ancestral/GTR+I+G4/fiveUTR_muscle_ires2_nt_hmm_gtr_ancestral.fasta")
fiveUTR_muscle_ires2_nt_gtr_ancestral <- read.table("./data/5UTR_IRES2_MUSCLE_Ancestral/GTR+I+G4/5UTR_MUSCLE_ires2_NT.fasta.raxml.ancestralStates")
View(fiveUTR_muscle_ires2_nt_hmm_gtr_ancestral)
View(fiveUTR_muscle_ires2_nt_gtr_ancestral)
colnames(fiveUTR_muscle_ires2_nt_gtr_ancestral) <- c("seq.name", "seq.text")
## Write to directory
dat2fasta(fiveUTR_muscle_ires2_nt_gtr_ancestral, "./data/5UTR_IRES2_MUSCLE_Ancestral/GTR+I+G4/fiveUTR_muscle_ires2_nt_gtr_ancestral.fasta")
fiveUTR_muscle_ires3_nt_hmm_hky_ancestral <- read.table("./data/5UTR_IRES3_MUSCLE_Trimmed_Ancestral/HKY+F+G4/5UTR_MUSCLE_ires3_NT_hmm.fasta.raxml.ancestralStates")
colnames(fiveUTR_muscle_ires3_nt_hmm_hky_ancestral) <- c("seq.name", "seq.text")
View(fiveUTR_muscle_ires3_nt_hmm_hky_ancestral)
## Write to directory
dat2fasta(fiveUTR_muscle_ires3_nt_hmm_hky_ancestral, "./data/5UTR_IRES3_MUSCLE_Trimmed_Ancestral/HKY+F+G4/fiveUTR_muscle_ires3_nt_hmm_hky_ancestral.fasta")
